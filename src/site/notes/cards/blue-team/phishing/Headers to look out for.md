---
{"dg-publish":true,"permalink":"/cards/blue-team/phishing/headers-to-look-out-for/"}
---

[[cards/blue-team/phishing/Email Analysis\|Email Analysis]]
## Headers to look out for
---
- **Date** 
	- when was the email composed or sent.
- **From** 
	- however keep in mind that this can be spoofed.
- **Subject**
- **Message-ID** generated by the first MTA it traverses through - always and should be unique. format: `<long_string>;domain_name|IPAddress`
	- A great way to compare if the identified mail system domain is different from this header.
	- One Instance of sending = One Message-ID.
- **To** 
	- Is the email sent to others as well or hidden through the use of **Blind Carbon Copy (BCC)**?
	- This is where the above headers starts being useful when investigating in the email gateway.
- **Reply-To** 
	- The address where the replies from the email goes to.
	-  When attacker spoofs email address - they typically change the `reply-to` as they don't have access to the spoofed email address. 
- **Return-Path**
	- Is used for bounce back email messages, it could have a different email value for legitimate purposes but in a typical mass phishing campaign - if attacker does not care about bounce back messages they send it to somewhere else.
	- The domain found in `return-path` is used for querying [[cards/blue-team/phishing/Sender Policy Framework (SPF)\|Sender Policy Framework (SPF)]] records.
- **Received** 
	- The headers that MTAs adds when the email is passed through them.
	- **Reverse** The lowest `Received` header is the closest to the sender or the originating server.
	- It can be spoofed - The **last server** before the email reaches your **trusted servers** (e.g., Microsoft, Gmail, or your organization's MTA) is the most reliable point of trust, since its identity is known or controlled by you or your email provider.
	- It can be cross-correlated with `X-Sender/Originate-IP`, perform reverse IP lookup with tools such as `whois` and mxtoolbox.

**Non-standarized headers** depending on the email client this headers may or may not be present/different.
- **X-Sender/Originate-IP** is the address of the server which the email originated from.

**Sample and challenges**
- [[cards/blue-team/phishing/challenges/Chase Bank Account Unusual Activities\|Chase Bank Account Unusual Activities]] - context.
- [[Challenges TimeKeeping\|Challenges TimeKeeping]]
### Authentication Checks
---
- [[cards/blue-team/phishing/Sender Policy Framework (SPF)#Sample Analysis\|SPF Analysis]] 
	- The SPF checks happen on the **immediate sending server IP address** and uses the **domain found** from the `return-path` (also known as `MAIL FROM` and `Envelope From`) to query DNS and see if the sending IP is listed.
- [[cards/blue-team/phishing/DomainKeys Identified Mail (DKIM)\|DomainKeys Identified Mail (DKIM)]] 

**Note:** continuation from same sample from above links:

![Pasted image 20250105152300.png](/img/user/cards/blue-team/phishing/images/Pasted%20image%2020250105152300.png)
- The two DKIM signature passed for both namecheap and sendgrid.
- The SPF passed.
- dmarc passed.