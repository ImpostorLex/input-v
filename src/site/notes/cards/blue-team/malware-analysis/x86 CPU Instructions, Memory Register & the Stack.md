---
{"dg-publish":true,"permalink":"/cards/blue-team/malware-analysis/x86-cpu-instructions-memory-register-and-the-stack/","tags":["malware"]}
---

[[cards/blue-team/malware-analysis/Advanced Static Analysis\|Advanced Static Analysis]]
### Introduction 
---
This is how a binary executes in a x86 architecure, it involves the CPU instructions, Memory Registers, and the stack.

x86 architecure _little endian_ meaning data is written from the right to the left - programming languages such as C or C++ is compiled by a compiler to assembly language and an assembler converts the assembly language into machine code.

![Pasted image 20240527140908.png|450](/img/user/cards/blue-team/malware-analysis/images/Pasted%20image%2020240527140908.png)

## CPU Instructions
---
Are the fundamentals or core commands executed by a CPU, such as:

1. **Data Movement Instructions**: These move data between registers, memory, and the CPU.
    
    - `MOV`: Transfer data from one location to another.
    - `PUSH` and `POP`: Transfer data to and from the stack.

2. **Arithmetic and Logic Instructions**: Perform mathematical and logical operations.
    
    - `ADD`, `SUB`: Addition and subtraction.
    - `MUL`, `DIV`: Multiplication and division.
    - `AND`, `OR`, `XOR`: Bitwise logical operations.

3. **Control Flow Instructions**: Direct the sequence of execution.
    
    - `JMP`: Unconditional jump to another instruction.
    - `JE`, `JNE`: Conditional jumps based on the result of previous operations (e.g., jump if equal or not equal).

## Memory Registers
---
Are small, fast storage locations within the CPU used to hold temporary data and instructions:

 1. **General Purpose Registers**: Used for a variety of operations.
    
    - `EAX`, `EBX`, `ECX`, `EDX`: Commonly used for arithmetic operations, loops, and data storage.
    - `ESI`, `EDI`: Often used as index registers for string operations.

2. **Index Registers**: Used for indexed addressing.

- `EIP` (Instruction Pointer): Points to the next instruction to be executed.
- `ESP` (Stack Pointer): Points to the top of the stack.
- `EBP` (Base Pointer): Used to point to the base of the current stack frame
## Stack
---
Is a special region of memory that operates in a last-in, first-out (LIFO) manner. It is used to store temporary data such as function parameters, return addresses, and local variables.

- **Push Operation**: Adds an item to the top of the stack.
    - E.g., `PUSH EAX` stores the value of `EAX` on the stack.

- **Pop Operation**: Removes an item from the top of the stack.
    - E.g., `POP EAX` retrieves the last pushed value from the stack into `EAX`

## Conclusion
---

## Reference 
---

[[x86 Assembly\|x86 Assembly]]

