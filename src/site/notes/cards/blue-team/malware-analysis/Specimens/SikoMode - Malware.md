---
{"dg-publish":true,"permalink":"/cards/blue-team/malware-analysis/specimens/siko-mode-malware/","tags":["specimen"]}
---

[[map-of-contents/malware\|malware]] 
### Introduction 
---
## Basic Analysis
---
### Static
---
1. VirusTotal shown no output using **sha256** hash.
2. Notable strings and imports are: ![[Pasted image 20240607202503.png\|350]]
3. Binary does not seem to be packed as virtual and raw are almost the same.
4. Strings came out many times: AWAVAUATUWVSH
5. `@C:\Users\Public\passwrd.txt` 
6. HTTP is seen. @http://cdn.altimiter.local/feed?post=
### Dynamic
#### Initial Detonation 
---
- The file deletes itself
- It makes contact to a update..... .local domain. however the domain is not hard-coded and programatically made with grep.

### Second Detonation
---
- The password.txt it created have a value of : SikoMode on User's Public directory.

![[Pasted image 20240607205122.png\|Pasted image 20240607205122.png]]

- My initial theory is the second call back domain is where the data extracted is being send.

![[Pasted image 20240607205608.png\|Pasted image 20240607205608.png]]

- The file being extracted is **cosmo.jpeg** and it is base64 encoded.

## Advanced Analysis
---
### Static
---
The program is made in NIM and it has three main function to go first before actually going to the main function:

![[Pasted image 20240607221545.png\|Pasted image 20240607221545.png]]

Then most notably is this one and this confirms, in one of our basic dynamic analysis a kill switch:

![[Pasted image 20240607221621.png\|Pasted image 20240607221621.png]]

And interesing function calls here:

![[Pasted image 20240607221840.png\|Pasted image 20240607221840.png]]


### Dynamic
---



## Challenge Questions:
---

- What language is the binary written in? **NIM (X)** 
- What is the architecture of this binary? **64 bit**
- Under what conditions can you get the binary to delete itself? **If the binary cannot contact the specified host (or no Internet connection.)**
- Does the binary persist? If so, how? **Binary has no persistence mechanism (X)**
- What is the first callback domain? **update.ec12-4-109-278-3-ubuntu20-04.local**
- Under what conditions can you get the binary to exfiltrate data? **If the second callback domain is reachable**
- What is the exfiltration domain? **cdn.altimiter.local**
- How does exfiltration take place? **Through HTTP GET request. maybe data is recorded on logs depending on the backend.**
- What URI is used to exfiltrate data? `http://cdn.altimiter.local/feed?post=`
- What type of data is exfiltrated (the file is cosmo.jpeg, but how exactly is the file's data transmitted?) **the malware takes cosmo and base64 encode it (X)**
- What kind of encryption algorithm is in use? **RC4 (X)**
- What key is used to encrypt the data? **SikoMode (-)**
- What is the significance of `houdini`? **It is a function to delete itself (X)** 


## Prerequisites
---
## Subtopic 1
---
### Questions and Problems
---
## Conclusion
---

