---
{"dg-publish":true,"permalink":"/cards/blue-team/malware-analysis/basic-dynamic-analysis/","tags":["malware"]}
---

[[map-of-contents/malware\|malware]] 
### Introduction 
---
Is when we detonate the malware and observe its behavior with limited tools and time.
## Before Detonation
---
Make sure that all the tools, backups, and anything important for the analysis are ready because some malware upon failed execution due to dependencies will delete itself such as malware can't contact the Internet.

- Wireshark
- Inetsim
### Upon Detonation: Host vs Network based Indicators
---
**Host** based indicators are events that only happens at the host such as deleting a file while **network** based indicators makes a event outside the host such as downloading a file from the Internet.
## Host-based Analysis
---
Using `procmon`:

Since we still have no idea what it does, we can use the filter and use the filename of the binary as the input:

![Pasted image 20240522163823.png](/img/user/cards/blue-team/malware-analysis/images/Pasted%20image%2020240522163823.png)

- Play with the `Operation` filter such as "File" to get all operation related to files.
- You can also put information found in [[cards/blue-team/malware-analysis/Basic Static Analysis\|Basic Static Analysis]] as filters.
- You can try and open up WireShark at the Flare-VM
- Make sure to watch out for the details section as well. There are maybe commandline commands.

```bash
vim C:\Windows\System32\drivers\etc\hosts
```

 > [!tip]+ 
 > It is usually recommend to run the binary and get the PID and use it as filter instead because we can see all the child or spawned process.

## After Detonation
---
- Persistence?
- Malware communicating or opening a socket? Use TCPview and test it out alongside with `netcat`.
- ProcessTree of ProcMon too.

[[cards/blue-team/malware-analysis/Specimens/RAT.CommandShell.exe\|RAT.CommandShell.exe]] - 

A sandbox by [Hatching Triage](https://tria.ge) free.

### Questions and Problems
---
## Conclusion
---
## Reference 
---
[[cards/blue-team/malware-analysis/Advanced Static Analysis\|Advanced Static Analysis]]

